<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: gui/SceneBar.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: gui/SceneBar.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * MLJLib
 * MeshLabJS Library
 * 
 * Copyright(C) 2015
 * Paolo Cignoni 
 * Visual Computing Lab
 * ISTI - CNR
 * 
 * All rights reserved.
 *
 * This program is free software; you can redistribute it and/or modify it under 
 * the terms of the GNU General Public License as published by the Free Software 
 * Foundation; either version 2 of the License, or (at your option) any later 
 * version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT 
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS 
 * FOR A PARTICULAR PURPOSE. See theGNU General Public License 
 * (http://www.gnu.org/licenses/gpl.txt) for more details.
 * 
 */

/**
 * @file Defines and installs the SceneBar widget 
 * @author Stefano Gabriele
 */
(function (component) {
    /**         
     * @class Create a new SceneBar widget
     * @augments  MLJ.gui.Widget
     * @private
     * @memberOf MLJ.gui.widget
     * @author Stefano Gabriele 
     */
    var _SceneBar = function () {

        var _toolBar = new component.ToolBar();
        var _dialog = new component.Dialog({
            title:"Save mesh", modal:true, draggable: false, resizable:false
        });        
        
        var _html =  "&lt;div id='mlj-save-dialog'>&lt;label for='filename'>Name:&lt;/label>&lt;br/>";
            _html += "&lt;input id='filename' type='text'/>";
            _html += "&lt;label for='extension'>Extension:&lt;/label>&lt;br/>";
            _html += "&lt;select id='extension'>";
        
        var ext;
        for(var key in MLJ.core.File.SupportedExtensions) {
            ext = MLJ.core.File.SupportedExtensions[key];
            _html +="&lt;option name='"+ext+"'>"+ext+"&lt;/option>";
        }       
         
        _html += "&lt;/select>";
        _html += "Compress? &lt;input name='zip' id='zipCheck' type='checkbox' value='1'>"
        _html += "&lt;div id='button-wrapper'>&lt;button id='mlj-save-dialog-button'>Save&lt;/button>&lt;/div>&lt;/div>";
        _dialog.appendContent(_html);
        
        
        var _dialogUpload = new component.Dialog({
            title:"Upload mesh", modal:true, draggable: false, resizable:false
        });
        
         var _html = "&lt;div id='mlj-upload-dialog'>";
            _html += "&lt;br/>&lt;label for='website'>Website:&lt;/label> ";
            _html += "&lt;select id='website' style='width: 150px; margin-left: 10px;'>";
        
        var ext;
        for(var key in MLJ.core.File.SupportedWebsites) {
            ext = MLJ.core.File.SupportedWebsites[key];
            _html +="&lt;option name='"+ext+"'>"+ext+"&lt;/option>";
        }       
         
        _html += "&lt;/select>";
        _html += "&lt;div id='button-wrapper'>&lt;button id='mlj-upload-dialog-button'>Upload&lt;/button>&lt;/div>&lt;/div>";
        _dialogUpload.appendContent(_html);        
        

        function init() {

            var open = new component.FileButton({
                tooltip: "Open mesh file",
                icon: "img/icons/IcoMoon-Free-master/PNG/48px/0049-folder-open.png",
                multiple: true
            });
                        

            var save = new component.Button({
                tooltip: "Save mesh file",
                icon: "img/icons/IcoMoon-Free-master/PNG/48px/0099-floppy-disk.png"
            });
            
            MLJ.gui.disabledOnSceneEmpty(save);
            
            var reload = new component.Button({
                tooltip: "Reload mesh file",
                icon: "img/icons/IcoMoon-Free-master/PNG/48px/0133-spinner11.png"
            });
                                                          
            MLJ.gui.disabledOnSceneEmpty(reload);
            //The reload button must be disalbed if the layer is created by a
            //creation filter
            MLJ.gui.disabledOnCreationFilterMesh(reload);

            var snapshot = new component.Button({
                tooltip: "Take snapshot",
                icon: "img/icons/IcoMoon-Free-master/PNG/48px/0016-camera.png"
            });
            
            MLJ.gui.disabledOnSceneEmpty(snapshot);

            var deleteLayer = new component.Button({
                tooltip: "Delete current layer",
                icon: "img/icons/IcoMoon-Free-master/PNG/48px/0173-bin.png"
            });
            
            var resetTrackball = new component.Button({
                tooltip: "Reset trackball",
                icon: "img/icons/home.png"
            });
            
            var uploadToWebsite = new component.Button({
                tooltip: "Upload to website",
                icon: "img/icons/IcoMoon-Free-master/PNG/48px/0199-upload2.png"
//                icon: "img/icons/upload-arrow.png"
            });
            
            var doc = new component.Button({
                tooltip: "Go to the documentation page",
                icon: "img/icons/question.png",
				right:true
            });
            
            var git = new component.Button({
                tooltip: "Go to the Github page",
                icon: "img/icons/github.png",
				right:true
            });
            
            MLJ.gui.disabledOnSceneEmpty(deleteLayer);
            MLJ.gui.disabledOnSceneEmpty(resetTrackball);
            MLJ.gui.disabledOnSceneEmpty(uploadToWebsite);
            
            _toolBar.add(open, save, uploadToWebsite, reload, resetTrackball, snapshot, deleteLayer);
			_toolBar.add(doc,git);

            // SCENE BAR EVENT HANDLERS
            open.onChange(function (input) {
                MLJ.core.File.openMeshFile(input.files);
            });
			doc.onClick(function () {
				 var win = window.open("./doc/html/", '_blank');
					win.focus();
			});
			git.onClick(function () {
				 var win = window.open("https://github.com/cnr-isti-vclab/meshlabjs", '_blank');
					win.focus();
			});
            save.onClick(function () {
                var layer = MLJ.core.Scene.getSelectedLayer();
                //Name = meshInfo[0], extension = meshInfo[meshInfo.length-1]
                var meshInfo = layer.name.split(".");                
                _dialog.show();
                $('#mlj-save-dialog > #filename').val(meshInfo[0]);
                
                $('#mlj-save-dialog > #extension option[name=".'+meshInfo[meshInfo.length-1]+'"]')
                        .attr('selected','selected');
               
                $('#mlj-save-dialog-button').click(function() {                    
                    var name = $('#mlj-save-dialog > #filename').val();
                    var extension = $('#mlj-save-dialog > #extension').val();
                    if($('#mlj-save-dialog > #zipCheck').is(':checked')){
//                        console.log("COMPRESS");
                        MLJ.core.File.saveMeshFileZip(layer, name+extension, name+".zip");
                    }
                    else{ 
//                        console.log("DO NOT COMPRESS");
                        MLJ.core.File.saveMeshFile(layer, name+extension);
                    }
                    _dialog.destroy();
                    $(this).off();
                });
            });                        

            reload.onClick(function () {
                var mf = MLJ.core.Scene.getSelectedLayer();
                MLJ.core.File.reloadMeshFile(mf);
            });

            snapshot.onClick(function () {                
                MLJ.core.Scene.takeSnapshot();
            });

            deleteLayer.onClick(function() {
                MLJ.core.plugin.Manager.executeLayerFilter("Layer Delete", MLJ.core.Scene.getSelectedLayer())
            })
            
            resetTrackball.onClick(function() {
                MLJ.core.Scene.resetTrackball();
            })
            
            uploadToWebsite.onClick(function() {
                //TODO
                var layer = MLJ.core.Scene.getSelectedLayer();
                //Name = meshInfo[0], extension = meshInfo[meshInfo.length-1]
                var meshInfo = layer.name.split(".");                
                _dialogUpload.show();
                $('#mlj-upload-dialog-button').click(function() {        
                    var website = $('#mlj-upload-dialog > #website').val();
                    
                    if(website === MLJ.core.File.SupportedWebsites["SKF"]){
                        
                        var sketchFabDialog = new component.Dialog({
                         title:"Upload to Sketchfab", modal:true, draggable: false, resizable:false
                        });        

//                        sketchFabDialog.appendContent("&lt;div id=prova> YOLO &lt;/div>");
                        var _html = "&lt;div id='sketchfabUpload'>";
                        _html += "Extension: &lt;select id='extension'>";
        
                        var ext;
                        for(var key in MLJ.core.File.SupportedSketchfabExtensions) {
                            ext = MLJ.core.File.SupportedSketchfabExtensions[key];
                            _html +="&lt;option name='"+ext+"'>"+ext+"&lt;/option>";
                        }       

                        _html += "&lt;/select>";     
                        _html += " Compress? &lt;input name='zip' id='zipCheck' type='checkbox' value='1'>"
                        _html += "&lt;form id='the-form' action='https://api.sketchfab.com/v2/models' enctype='multipart/form-data'>";
//                        _html += "Upload your model file: &lt;br> &lt;input name='modelFile' type='file'> &lt;br>&lt;br>";
                        _html += "&lt;br> API Token: &lt;input name='token' id='token' type='text'>";
                        _html += "&lt;br>&lt;br> Model name: &lt;p id='nameCounter'> 48 &lt;/p> &lt;input name='name' id='name' type='text' maxlength='48'>";
                        _html += "&lt;br>&lt;br> Model description: &lt;p id='descriptionCounter'> 810 &lt;/p> &lt;textarea name='description' id='description' rows='3' maxlength='810'>&lt;/textarea>";
                        _html += "&lt;br>&lt;br> Tags (space separated): &lt;input name='tags' type='text'>";
                        _html += "&lt;br>&lt;br> Private? (Pro only) &lt;input name='private' id='private' type='checkbox' value='1'>";
                        _html += "&lt;br>&lt;br> Password (Pro only): &lt;p id='passwordCounter'> 64 &lt;/p> &lt;input name='password' id='password' type='password' maxlength='64'>";
                        _html += "&lt;br>&lt;br> &lt;p> Max file size: Free 50 MB; Pro 200 MB; Business 500 MB&lt;/p>";
                        _html += "&lt;input name='Submit' id='uploadButton' type='submit' value='Upload'>&lt;/form>"; 
                        sketchFabDialog.appendContent(_html);
                        sketchFabDialog.show();
                          
                        $('#sketchfabUpload #name').val(meshInfo[0]);
                        $('#sketchfabUpload #extension option[name=".'+meshInfo[meshInfo.length-1]+'"]').attr('selected','selected');
                        $("#private").prop('checked', false);
                        $("#password").prop('disabled', false);
                        $("#private").change(function() {
                            if(this.checked) {
                                $("#password").prop('disabled', false);
                            }
                            else {
                                $("#password").prop('disabled', true);
                            }
                        });
                        
                        var characterCounter = function() {
                                var text_remaining = $(this).attr('maxLength') - $(this).val().length;
                                var counterId = $(this).attr('id') +"Counter";
                                if(text_remaining &lt;= 10){
                                    $('#'+counterId).addClass("overflow");
                                    $('#'+counterId).text(text_remaining);
                                }
                                else{
                                    $('#'+counterId).text(text_remaining);
                                    $('#'+counterId).removeClass("overflow");
                                }
                            };
                            
                            $('#name').keyup(characterCounter);
                            $('#nameCounter').text($('#name').attr('maxLength') - $('#name').val().length);
                            $('#description').keyup(characterCounter);
                            $('#password').keyup(characterCounter);
                            
                            $('#uploadButton').prop('disabled', true);
                            $('#token').keyup(function() {
                                if($(this).val().length &lt;= 0){
                                    $('#uploadButton').prop('disabled', true);
                                }
                                else{
                                    $('#uploadButton').prop('disabled', false);                                    
                                }
                            });
                        
                        $('#the-form').submit(function(event) {
                            event.preventDefault();
                            var extension = $('#sketchfabUpload > #extension').val();
                            var zipBool = $('#sketchfabUpload > #zipCheck').is(':checked');
                            var statusUpdateDialog = new component.Dialog({  title:"Upload to Sketchfab", modal:true, draggable: false, resizable:false });  
                            _html = "&lt;p style='display:inline'>Status:&lt;/p> &lt;p id='status' style='display:inline'> &lt;/p>";
                            _html += "&lt;div id='sketchfabProgressBar'> &lt;div id='progressBar'> &lt;div id='pBarLabel'>0%&lt;/div> &lt;/div> &lt;/div>"
                            _html += "&lt;button id='exitUpdateButton' type='button'> Cancel &lt;/button>";
                            statusUpdateDialog.appendContent(_html);
                            statusUpdateDialog.show();
                            
                            MLJ.core.File.uploadToSketchfab(layer, extension, zipBool, statusUpdateDialog);
                            sketchFabDialog.destroy();
                        });
                    }
                    _dialogUpload.destroy();
                    $(this).off();
                });
            })                                             
        }
        
        /**
         * @author Stefano Gabriele         
         */
        this._make = function () {
            _toolBar.$.attr("id", "mlj-scenebar-widget");
            return _toolBar.$;
        };

        init();

        MLJ.gui.Widget.call(this);
    };

    MLJ.extend(MLJ.gui.Widget, _SceneBar);

    //Install widget
    MLJ.gui.installWidget("SceneBar", new _SceneBar());

})(MLJ.gui.component);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="MLJ.core.AmbientLight.html">MLJ.core.AmbientLight</a></li><li><a href="MLJ.core.Headlight.html">MLJ.core.Headlight</a></li><li><a href="MLJ.core.Layer.html">MLJ.core.Layer</a></li><li><a href="MLJ.core.plugin.BaseRendering.html">MLJ.core.plugin.BaseRendering</a></li><li><a href="MLJ.core.plugin.Filter.html">MLJ.core.plugin.Filter</a></li><li><a href="MLJ.core.plugin.GlobalRendering.html">MLJ.core.plugin.GlobalRendering</a></li><li><a href="MLJ.core.plugin.GUIBuilder.html">MLJ.core.plugin.GUIBuilder</a></li><li><a href="MLJ.core.plugin.Plugin.html">MLJ.core.plugin.Plugin</a></li><li><a href="MLJ.Error.html">MLJ.Error</a></li><li><a href="MLJ.gui.component.Accordion.html">MLJ.gui.component.Accordion</a></li><li><a href="MLJ.gui.component.AccordionEntry.html">MLJ.gui.component.AccordionEntry</a></li><li><a href="MLJ.gui.component.Button.html">MLJ.gui.component.Button</a></li><li><a href="MLJ.gui.component.ButtonSet.html">MLJ.gui.component.ButtonSet</a></li><li><a href="MLJ.gui.component.CheckBox.html">MLJ.gui.component.CheckBox</a></li><li><a href="MLJ.gui.component.ColorPicker.html">MLJ.gui.component.ColorPicker</a></li><li><a href="MLJ.gui.component.ComboBox.html">MLJ.gui.component.ComboBox</a></li><li><a href="MLJ.gui.component.Component.html">MLJ.gui.component.Component</a></li><li><a href="MLJ.gui.component.CustomToggleButton.html">MLJ.gui.component.CustomToggleButton</a></li><li><a href="MLJ.gui.component.Dialog.html">MLJ.gui.component.Dialog</a></li><li><a href="MLJ.gui.component.FileButton.html">MLJ.gui.component.FileButton</a></li><li><a href="MLJ.gui.component.Label.html">MLJ.gui.component.Label</a></li><li><a href="MLJ.gui.component.LayerSelection.html">MLJ.gui.component.LayerSelection</a></li><li><a href="MLJ.gui.Component.MLJ.gui.component.RangedFloat.html">MLJ.gui.Component.MLJ.gui.component.RangedFloat</a></li><li><a href="MLJ.gui.component.Pane.html">MLJ.gui.component.Pane</a></li><li><a href="MLJ.gui.component.PiP.html">MLJ.gui.component.PiP</a></li><li><a href="MLJ.gui.component.Spinner.html">MLJ.gui.component.Spinner</a></li><li><a href="MLJ.gui.component.TextField.html">MLJ.gui.component.TextField</a></li><li><a href="MLJ.gui.component.ToggleButton.html">MLJ.gui.component.ToggleButton</a></li><li><a href="MLJ.gui.component.ToolBar.html">MLJ.gui.component.ToolBar</a></li><li><a href="MLJ.gui.Param.html">MLJ.gui.Param</a></li><li><a href="MLJ.gui.Param.Color.html">MLJ.gui.Param.Color</a></li><li><a href="MLJ.gui.Param.LayerSelection.html">MLJ.gui.Param.LayerSelection</a></li><li><a href="MLJ.gui.Param.RangedFloat.html">MLJ.gui.Param.RangedFloat</a></li><li><a href="MLJ.gui.Widget.html">MLJ.gui.Widget</a></li><li><a href="MLJ.gui.widget._Info.html">MLJ.gui.widget._Info</a></li><li><a href="MLJ.gui.widget._LayersPane.html">MLJ.gui.widget._LayersPane</a></li><li><a href="MLJ.gui.widget._Log.html">MLJ.gui.widget._Log</a></li><li><a href="MLJ.gui.widget._Logo.html">MLJ.gui.widget._Logo</a></li><li><a href="MLJ.gui.widget._SceneBar.html">MLJ.gui.widget._SceneBar</a></li><li><a href="MLJ.gui.widget._SearchTool.html">MLJ.gui.widget._SearchTool</a></li><li><a href="MLJ.util.AssociativeArray.html">MLJ.util.AssociativeArray</a></li><li><a href="MLJ.util.AssociativeArray-_Iterator.html">MLJ.util.AssociativeArray~_Iterator</a></li></ul><h3>Events</h3><ul><li><a href="MLJ.core.File.html#event:MeshFileOpened">MLJ.core.File#event:MeshFileOpened</a></li><li><a href="MLJ.core.File.html#event:MeshFileReloaded">MLJ.core.File#event:MeshFileReloaded</a></li><li><a href="MLJ.core.Scene.html#event:SceneLayerAdded">MLJ.core.Scene#event:SceneLayerAdded</a></li><li><a href="MLJ.core.Scene.html#event:SceneLayerReloaded">MLJ.core.Scene#event:SceneLayerReloaded</a></li><li><a href="MLJ.core.Scene.html#event:SceneLayerSelected">MLJ.core.Scene#event:SceneLayerSelected</a></li><li><a href="MLJ.core.Scene.html#event:SceneLayerUpdated">MLJ.core.Scene#event:SceneLayerUpdated</a></li></ul><h3>Namespaces</h3><ul><li><a href="MLJ.html">MLJ</a></li><li><a href="MLJ.core.File.html">MLJ.core.File</a></li><li><a href="MLJ.core.plugin.html">MLJ.core.plugin</a></li><li><a href="MLJ.core.Scene.html">MLJ.core.Scene</a></li><li><a href="MLJ.gui.html">MLJ.gui</a></li><li><a href="MLJ.gui.component.html">MLJ.gui.component</a></li><li><a href="MLJ.gui.widget_.html">MLJ.gui.widget</a></li><li><a href="MLJ.util.html">MLJ.util</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Module">Module</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Tue Mar 29 2016 10:13:48 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
